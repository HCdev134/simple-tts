<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TTS Example</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div class="container">
        <h1 style="text-align: center;"> Voices </h1>
        <select name="" id="voicelist" style="text-align: center;"></select>
        <br></br>
        <input type="text" id="tts">
        <br></br>

  
        <button id="tts-btn" class="btn-grad"> TTS </button>
        <button id="hello-btn" class="btn-grad">Hello World</button>
        <button id="voices-btn" class="btn-grad">Populate Voices List</button>
    </div>
    <div class="container">
        <div class="ranges">
            Rate:<br> <input type="range" min="0.5" max="2" value="1" step="0.1" class="slider" id="rate"> 
            <div class="rate-value">1</div>
            <div class="clearfix"></div>
          </div>
          <div class="ranges">
            Pitch:<br> <input type="range" min="0" max="2" value="1" step="0.1" class="slider" id="pitch">
            <div class="pitch-value">1</div>
            <div class="clearfix"></div>
          </div>
    </div>
    
    <div class="container">
        <div class="description">
            <h4>TTS V 2.1</h4>
            <span class="fa fa-check" style="color:#033">New</span><br>
            Range Sliders Work On Desktop <br> 
            FIXED: TTS speaking more than once on firefox 
            The Button Is Generally Sensitive To Clicks <br>
            Clicking the TTS Button will cause the voice to speak twice (In Firefox)
            see: <span class="green fa fa-check" style="color: #030113;">FIXED</span>
            (https://stackoverflow.com/questions/44395423/why-cant-speechsynthesis-speak-be-called-more-than-once-in-firefox)
            <br></br>

            Type Whatever You Want <br>
            Select Voices From the List <br>
            The script will pull the voices from your computer (whatever voices you have natively on your
            computer/phone) <br></br>
            Click the TTS button and it will play what you type <br></br>

            Page Has to be refreshed if voices are not showing in the select > options list


        </div>
    </div>


    <script src="./orig-tts.js"></script>
    <!-- <script>

        var pop_voices = document.querySelector("#voices-btn");
        pop_voices.onclick = function () {


            location.reload(true);

        }
        // Elements 
        var voiceList = document.querySelector("#voicelist");
        var tts_input = document.querySelector("#tts");
        var tts_button = document.querySelector("#tts-btn");


        // TTS API , TTS speech object
        var tts_main = window.speechSynthesis;

        // Voices Go in this array, which will be used in function getVoices()
        var voices = [];


        tts_button.addEventListener("click", () => {

            var toSpeak = new SpeechSynthesisUtterance(tts_input.value);
            var selectedVoiceName = voiceList.selectedOptions[0].getAttribute("data-name");
            voices.forEach((voice) => {
                if (voice.name === selectedVoiceName) {
                    toSpeak.voice = voice;
                }
                tts_main.speak(toSpeak);
                console.log(tts_main.speaking); 
            });
            // tts_input.blur()

        })

        speechSynthesis.getVoices().forEach(function (voice) {
            console.log(voice.name, voice.default ? voice.default : '');
        });

        getVoices();
        console.log(`Voices: ${getVoices()}`);

        if (speechSynthesis == "undefined") {
            speechSynthesis.onvoiceschanged = getVoices;
        }
        function getVoices() {
            voices = tts_main.getVoices()
            voiceList.innerHTML = "";
            voices.forEach((voice) => {
                var listItem = document.createElement("option");
                listItem.textContent = voice.name;

                listItem.setAttribute("data-lang", voice.lang);
                listItem.setAttribute("data-name", voice.name);
                console.log(listItem);
                voiceList.appendChild(listItem);
            });

            voiceList.selectedOptions = 0;
        }

        // document.getElementById("hello-btn").onclick = function speaker() {

        //     if (window.speechSynthesis.speaking) {
        //         window.speechSynthesis.cancel();
        //     }
        //     var tts_string_instance = "Here is a string of text";


        //     var msg = new SpeechSynthesisUtterance(tts_string_instance);
        //     msg.lang = 'en-US';
        //     // msg.text = "Hello World"; 
        //     window.speechSynthesis.speak(msg);
        // }

    </script> -->
</body>

</html>